<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>éŸ³æ•ˆæŒ‰é’®</title>
    <script>
        // é¢„åŠ è½½ electron
        const { ipcRenderer } = require('electron');

        // åˆå§‹åŒ–å…¨å±€å˜é‡
        window.currentAudio = null;
        window.selectedAudioOutput = 'default';

        // éŸ³é¢‘è®¾å¤‡åˆå§‹åŒ–å‡½æ•°
        async function initAudioOutputs() {
            const audioSelect = document.getElementById('audioOutput');
            if (!audioSelect) {
                console.error('Audio select element not found');
                return;
            }

            try {
                // å…ˆè®¾ç½®é»˜è®¤é€‰é¡¹
                audioSelect.innerHTML = '<option value="default">ç³»ç»Ÿé»˜è®¤è¾“å‡º</option>';

                // è¯·æ±‚éŸ³é¢‘æƒé™å¹¶è·å–è®¾å¤‡åˆ—è¡¨
                const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
                stream.getTracks().forEach(track => track.stop());

                const devices = await navigator.mediaDevices.enumerateDevices();
                console.log('Found audio devices:', devices);

                // è¿‡æ»¤å¹¶æ·»åŠ éŸ³é¢‘è¾“å‡ºè®¾å¤‡
                const outputs = devices.filter(device => device.kind === 'audiooutput');
                outputs.forEach(device => {
                    if (device.deviceId !== 'default' && device.deviceId !== 'communications') {
                        const option = document.createElement('option');
                        option.value = device.deviceId;
                        option.text = device.label || `éŸ³é¢‘è®¾å¤‡ ${device.deviceId.slice(0, 5)}`;
                        audioSelect.appendChild(option);
                    }
                });

                // è®¾ç½®è®¾å¤‡åˆ‡æ¢äº‹ä»¶
                audioSelect.onchange = async (e) => {
                    const deviceId = e.target.value;
                    window.selectedAudioOutput = deviceId;
                    
                    if (window.currentAudio && window.currentAudio.setSinkId) {
                        try {
                            await window.currentAudio.setSinkId(deviceId);
                            showNotification('å·²åˆ‡æ¢éŸ³é¢‘è¾“å‡ºè®¾å¤‡', 'success');
                        } catch (err) {
                            console.error('Error switching device:', err);
                            showNotification('åˆ‡æ¢è®¾å¤‡å¤±è´¥', 'error');
                        }
                    }
                };

            } catch (err) {
                console.error('Error initializing audio devices:', err);
                showNotification('æ— æ³•è®¿é—®éŸ³é¢‘è®¾å¤‡', 'error');
            }
        }

        // ä¸»è¦çš„åˆå§‹åŒ–å‡½æ•°
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('Initializing...');
                
                // åˆå§‹åŒ–éŸ³é¢‘è®¾å¤‡
                await initAudioOutputs();
                
                // æ³¨å†Œå¿«æ·é”®
                await registerAllHotkeys();
                
                // åˆå§‹åŒ–é»˜è®¤åˆ†ç±»
                const defaultTab = document.querySelector('.category-tabs .tab-item:not(#editTab)');
                if (defaultTab) {
                    defaultTab.click();
                }
                
                // åˆå§‹åŒ–çª—å£æ§åˆ¶
                const closeButton = document.querySelector('.close-button');
                if (closeButton) {
                    closeButton.addEventListener('click', () => {
                        ipcRenderer.send('close-window');
                    });
                }

                const minButton = document.querySelector('.min-button');
                if (minButton) {
                    minButton.addEventListener('click', () => {
                        ipcRenderer.send('minimize-window');
                    });
                }

                console.log('Initialization complete');
            } catch (error) {
                console.error('Error during initialization:', error);
            }
        });

        // 1. é¦–å…ˆå®šä¹‰é€šçŸ¥ç³»ç»Ÿå‡½æ•°ï¼ˆæ”¾åœ¨æœ€å‰é¢ï¼‰
        function showNotification(message, type = 'info', duration = 2000) {
            const container = document.getElementById('notificationContainer');
            if (!container) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            requestAnimationFrame(() => {
                notification.classList.add('show');
            });
            
            setTimeout(() => {
                notification.classList.add('hide');
                notification.addEventListener('animationend', () => {
                    notification.remove();
                });
            }, duration);
        }

        // é¦–å…ˆå®šä¹‰æ‰€æœ‰éœ€è¦çš„å‡½æ•°
        function createButton(category, index) {
            const button = document.createElement('button');
            button.className = 'sound-button';
            // ç”ŸæˆçœŸæ­£å”¯ä¸€çš„æŒ‰é’® ID
            const uniqueId = `${category}-button-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
            button.id = uniqueId;
            button.setAttribute('data-category', category);
            
            // åˆ›å»ºæ–‡æœ¬å®¹å™¨
            const textSpan = document.createElement('span');
            textSpan.textContent = ''; // åˆå§‹ä¸ºç©º
            button.appendChild(textSpan);
            
            // è®¾ç½®æ‹–æ”¾äº‹ä»¶
            button.ondragover = (e) => {
                e.preventDefault();
                button.classList.add('dragover');
            };

            button.ondragleave = (e) => {
                e.preventDefault();
                button.classList.remove('dragover');
            };

            button.ondrop = async (e) => {
                e.preventDefault();
                button.classList.remove('dragover');
                const file = e.dataTransfer.files[0];
                if (file && (file.type.startsWith('audio/') || file.name.endsWith('.mp3'))) {
                    try {
                        textSpan.textContent = file.name.replace('.mp3', '');
                        button.audioData = {
                            path: file.path,
                            name: file.name.replace('.mp3', '')
                        };
                        
                        const audio = new Audio(file.path);
                        button.audioData.audio = audio;
                        setupAudioEvents(button, audio);
                        button.classList.add('has-audio');
                        
                        await saveConfig();
                        
                        // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
                        showNotification('éŸ³æ•ˆæ·»åŠ æˆåŠŸï¼', 'success');
                        
                    } catch (err) {
                        console.error('Audio setup error:', err);
                        // æ˜¾ç¤ºé”™è¯¯é€šçŸ¥
                        showNotification('éŸ³æ•ˆæ·»åŠ å¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                    }
                } else {
                    // æ·»åŠ ééŸ³é¢‘æ–‡ä»¶çš„æç¤º
                    showNotification('è¯·æ‹–æ”¾éŸ³é¢‘æ–‡ä»¶', 'info');
                }
            };
            
            // æ·»åŠ å³é”®èœå•äº‹ä»¶
            button.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                
                // ç§»é™¤å·²å­˜åœ¨çš„èœå•
                const existingMenu = document.querySelector('.context-menu');
                if (existingMenu) {
                    existingMenu.remove();
                }

                // åˆ›å»ºèœå•
                const menu = document.createElement('div');
                menu.className = 'context-menu';
                
                // åˆ›å»ºèœå•é¡¹
                const menuItems = [
                    {
                        text: 'è®¾ç½®å¿«æ·é”®',
                        icon: 'âŒ¨ï¸',
                        onClick: () => {
                            showHotkeyDialog(button);
                            menu.remove();
                        }
                    },
                    {
                        text: 'æ¸…é™¤å¿«æ·é”®',
                        icon: 'âŒ',
                        onClick: () => {
                            removeHotkey(button);
                            menu.remove();
                        }
                    },
                    {
                        text: 'åˆ é™¤éŸ³æ•ˆ',
                        icon: 'ğŸ”‡',
                        onClick: () => {
                            if (button.audioData) {
                                button.audioData = null;
                                button.querySelector('span').textContent = '';
                                button.classList.remove('has-audio');
                                saveConfig();
                                showNotification('éŸ³æ•ˆå·²åˆ é™¤', 'success');
                            }
                            menu.remove();
                        }
                    },
                    {
                        text: 'åˆ é™¤æŒ‰é’®',
                        icon: 'ğŸ—‘ï¸',
                        onClick: async () => {
                            button.remove();
                            await saveConfig();
                            showNotification('æŒ‰é’®å·²åˆ é™¤', 'info');
                            menu.remove();
                        }
                    },
                    {
                        text: 'éŸ³ä¹å‰ªè¾‘',
                        icon: 'âœ‚ï¸',
                        onClick: () => {
                            showNotification('éŸ³ä¹å‰ªè¾‘åŠŸèƒ½å¼€å‘ä¸­...', 'info');
                            menu.remove();
                        }
                    },
                    {
                        text: 'éŸ³ä¹åŠ é€Ÿ',
                        icon: 'â©',
                        onClick: () => {
                            showNotification('éŸ³ä¹åŠ é€ŸåŠŸèƒ½å¼€å‘ä¸­...', 'info');
                            menu.remove();
                        }
                    }
                ];

                // æ·»åŠ èœå•é¡¹åˆ°èœå•
                menuItems.forEach(item => {
                    const menuItem = document.createElement('div');
                    menuItem.className = 'context-menu-item';
                    menuItem.innerHTML = `<span class="menu-icon">${item.icon}</span>${item.text}`;
                    menuItem.onclick = item.onClick;
                    menu.appendChild(menuItem);
                });

                // è°ƒæ•´èœå•ä½ç½®
                menu.style.left = `${e.clientX}px`;
                menu.style.top = `${e.clientY}px`;

                // æ·»åŠ åˆ°æ–‡æ¡£
                document.body.appendChild(menu);

                // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
                const closeMenu = (e) => {
                    if (!menu.contains(e.target)) {
                        menu.remove();
                        document.removeEventListener('click', closeMenu);
                    }
                };
                
                setTimeout(() => {
                    document.addEventListener('click', closeMenu);
                }, 0);
            });

            return button;
        }

        // æ·»åŠ å³é”®èœå•å‡½æ•°
        function showButtonContextMenu(e, button) {
            e.preventDefault();
            
            // ç§»é™¤å·²å­˜åœ¨çš„èœå•
            const existingMenu = document.querySelector('.context-menu');
            if (existingMenu) {
                existingMenu.remove();
            }

            // åˆ›å»ºèœå•
            const menu = document.createElement('div');
            menu.className = 'context-menu';
            
            // åˆ›å»ºèœå•é¡¹
            const menuItems = [
                {
                    text: 'è®¾ç½®å¿«æ·é”®',
                    icon: 'âŒ¨ï¸',
                    onClick: () => {
                        showHotkeyDialog(button);
                        menu.remove();
                    }
                },
                {
                    text: 'æ¸…é™¤å¿«æ·é”®',
                    icon: 'âŒ',
                    onClick: () => {
                        removeHotkey(button);
                        menu.remove();
                    }
                },
                {
                    text: 'åˆ é™¤éŸ³æ•ˆ',
                    icon: 'ğŸ”‡',
                    onClick: () => {
                        if (button.audioData) {
                            button.audioData = null;
                            button.querySelector('span').textContent = '';
                            button.classList.remove('has-audio');
                            saveConfig();
                            showNotification('éŸ³æ•ˆå·²åˆ é™¤', 'success');
                        }
                        menu.remove();
                    }
                },
                {
                    text: 'åˆ é™¤æŒ‰é’®',
                    icon: 'ğŸ—‘ï¸',
                    onClick: async () => {
                        button.remove();
                        await saveConfig();
                        showNotification('æŒ‰é’®å·²åˆ é™¤', 'info');
                        menu.remove();
                    }
                }
            ];

            // æ·»åŠ èœå•é¡¹åˆ°èœå•
            menuItems.forEach(item => {
                const menuItem = document.createElement('div');
                menuItem.className = 'context-menu-item';
                menuItem.innerHTML = `<span class="menu-icon">${item.icon}</span>${item.text}`;
                menuItem.onclick = item.onClick;
                menu.appendChild(menuItem);
            });

            // è°ƒæ•´èœå•ä½ç½®
            menu.style.left = `${e.clientX}px`;
            menu.style.top = `${e.clientY}px`;

            // æ·»åŠ åˆ°æ–‡æ¡£
            document.body.appendChild(menu);

            // ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
            const closeMenu = (e) => {
                if (!menu.contains(e.target)) {
                    menu.remove();
                    document.removeEventListener('click', closeMenu);
                }
            };
            
            setTimeout(() => {
                document.addEventListener('click', closeMenu);
            }, 0);
        }

        // ä¿®æ”¹ createButtons å‡½æ•°
        function createButtons(category) {
            const grid = document.getElementById('buttonGrid');
            if (!grid) {
                console.error('Button grid not found');
                return;
            }
            
            // æ¸…ç©ºç½‘æ ¼
            grid.innerHTML = '';
            
            // åˆ›å»ºæ–°çš„ç©ºç™½æŒ‰é’®
            const button = createButton(category, 0);
            grid.appendChild(button);
            
            // åˆ›å»ºæ·»åŠ æŒ‰é’®
            const addButton = document.createElement('button');
            addButton.className = 'add-sound-button';
            addButton.innerHTML = '+';
            addButton.onclick = () => {
                // åˆ›å»ºæ–°çš„ç©ºç™½æŒ‰é’®
                const newButton = createButton(category, grid.children.length);
                
                // åœ¨"+"æŒ‰é’®ä¹‹å‰æ’å…¥æ–°æŒ‰é’®
                grid.insertBefore(newButton, addButton);
            };
            
            grid.appendChild(addButton);
        }

        async function setupAudioEvents(button, audio) {
            try {
                // è®¾ç½®éŸ³é¢‘è¾“å‡ºè®¾å¤‡
                if (window.selectedAudioOutput && audio.setSinkId) {
                    try {
                        // ä½¿ç”¨å½“å‰é€‰æ‹©çš„éŸ³é¢‘è¾“å‡ºè®¾å¤‡
                        await audio.setSinkId(window.selectedAudioOutput);
                        console.log('Audio output set to:', window.selectedAudioOutput);
                    } catch (err) {
                        console.error('Error setting initial audio output:', err);
                    }
                }

                audio.ontimeupdate = () => {
                    if (audio.duration) {
                        // æ›´æ–°è¿›åº¦æ¡
                        const progress = (audio.currentTime / audio.duration) * 100;
                        const bottomBar = document.querySelector('.bottom-bar');
                        if (bottomBar) {
                            bottomBar.style.setProperty('--progress', `${progress}%`);
                        }

                        // æ›´æ–°æ—¶é—´æ˜¾ç¤º
                        const timeDisplay = document.querySelector('.time-display');
                        if (timeDisplay) {
                            const currentTime = formatTime(audio.currentTime);
                            const totalTime = formatTime(audio.duration);
                            timeDisplay.textContent = `${currentTime} / ${totalTime}`;
                        }
                    }
                };
                
                audio.onended = () => {
                    button.classList.remove('playing');
                    const bottomBar = document.querySelector('.bottom-bar');
                    if (bottomBar) {
                        bottomBar.style.setProperty('--progress', '0%');
                    }
                    // é‡ç½®æ—¶é—´æ˜¾ç¤º
                    const timeDisplay = document.querySelector('.time-display');
                    if (timeDisplay) {
                        timeDisplay.textContent = '00:00 / 00:00';
                    }
                    // é‡ç½®å½“å‰æ’­æ”¾æ˜¾ç¤º
                    const currentPlayingSpan = document.querySelector('.playback-controls span');
                    if (currentPlayingSpan) {
                        currentPlayingSpan.textContent = 'å½“å‰æ’­æ”¾: æ— ';
                    }
                };
                
                button.onclick = async () => {
                    try {
                        if (window.currentAudio) {
                            window.currentAudio.pause();
                            window.currentAudio.currentTime = 0;
                            document.querySelectorAll('.sound-button.playing').forEach(btn => {
                                btn.classList.remove('playing');
                            });
                        }

                        // åœ¨æ’­æ”¾å‰ç¡®ä¿ä½¿ç”¨æ­£ç¡®çš„éŸ³é¢‘è¾“å‡ºè®¾å¤‡
                        if (window.selectedAudioOutput && audio.setSinkId) {
                            await audio.setSinkId(window.selectedAudioOutput);
                        }
                        
                        audio.currentTime = 0;
                        await audio.play();
                        window.currentAudio = audio;
                        button.classList.add('playing');

                        // æ›´æ–°å½“å‰æ’­æ”¾æ˜¾ç¤º
                        const currentPlayingSpan = document.querySelector('.playback-controls span');
                        if (currentPlayingSpan) {
                            currentPlayingSpan.textContent = `å½“å‰æ’­æ”¾: ${button.audioData.name || 'æœªå‘½å'}`;
                        }
                    } catch (err) {
                        console.error('Error playing audio:', err);
                        showNotification('æ’­æ”¾å¤±è´¥ï¼Œè¯·æ£€æŸ¥éŸ³é¢‘è®¾å¤‡', 'error');
                    }
                };
            } catch (err) {
                console.error('Error in setupAudioEvents:', err);
                showNotification('éŸ³é¢‘è®¾ç½®å¤±è´¥', 'error');
            }
        }

        async function saveConfig() {
            try {
                // å…ˆè·å–å·²ä¿å­˜çš„é…ç½®
                const savedConfig = await ipcRenderer.invoke('load-config') || { buttons: [] };
                
                // è·å–å½“å‰åˆ†ç±»
                const currentCategory = document.querySelector('.category-tabs .tab-item.active').textContent;
                
                // ç§»é™¤å½“å‰åˆ†ç±»çš„æ—§æ•°æ®
                const otherButtons = savedConfig.buttons.filter(btn => btn.category !== currentCategory);
                
                // è·å–å½“å‰åˆ†ç±»çš„æ‰€æœ‰æŒ‰é’®ï¼ˆåŒ…æ‹¬ç©ºç™½æŒ‰é’®ï¼‰
                const currentButtons = [];
                document.querySelectorAll('.sound-button').forEach((button, index) => {
                    // ä¿å­˜æ‰€æœ‰æŒ‰é’®ï¼ŒåŒ…æ‹¬æ²¡æœ‰éŸ³é¢‘çš„ç©ºç™½æŒ‰é’®
                    currentButtons.push({
                        category: currentCategory,
                        index: index,
                        id: button.id, // ä¿å­˜æŒ‰é’® ID
                        name: button.querySelector('span').textContent || '',
                        audioPath: button.audioData ? button.audioData.path : '',
                        isEmpty: !button.audioData,
                        hotkey: button.getAttribute('data-hotkey') || '' // æ·»åŠ å¿«æ·é”®å­—æ®µ
                    });
                });
                
                // åˆå¹¶æ•°æ®
                const newConfig = {
                    buttons: [...otherButtons, ...currentButtons]
                };
                
                console.log('Saving config with hotkeys:', newConfig);
                await ipcRenderer.invoke('save-config', newConfig);
                
            } catch (err) {
                console.error('Save config error:', err);
            }
        }

        // æ·»åŠ ä¸€ä¸ªé™é»˜è®¾ç½®å¿«æ·é”®çš„å‡½æ•°
        async function setHotkeyQuietly(button, hotkey) {
            try {
                const electronHotkey = hotkey
                    .replace('Ctrl', 'CommandOrControl')
                    .replace(/\+/g, '+');
                    
                const success = await ipcRenderer.invoke('register-hotkey', {
                    hotkey: electronHotkey,
                    buttonId: button.id
                });

                if (success) {
                    // ä¸è¦æ¸…é™¤å…¶ä»–æŒ‰é’®çš„å¿«æ·é”®
                    button.setAttribute('data-hotkey', hotkey);
                    
                    let badge = button.querySelector('.hotkey-badge');
                    if (!badge) {
                        badge = document.createElement('div');
                        badge.className = 'hotkey-badge';
                        button.appendChild(badge);
                    }
                    badge.textContent = hotkey;
                }
            } catch (error) {
                console.error('Error setting hotkey:', error);
            }
        }

        // ç›¸åº”åœ°ä¿®æ”¹ loadConfig å‡½æ•°ä¸­çš„å¿«æ·é”®è®¾ç½®éƒ¨åˆ†
        async function loadConfig(category) {
            try {
                const config = await ipcRenderer.invoke('load-config');
                const grid = document.getElementById('buttonGrid');
                if (!grid) return;
                
                grid.innerHTML = '';
                
                if (config && config.buttons) {
                    // è¿‡æ»¤å½“å‰åˆ†ç±»çš„æŒ‰é’®
                    const categoryButtons = config.buttons.filter(btn => btn.category === category);
                    
                    // åˆ›å»ºæŒ‰é’®
                    categoryButtons.forEach(btnConfig => {
                        const button = createButton(category);
                        if (btnConfig.audioPath) {
                            const audio = new Audio(btnConfig.audioPath);
                            button.audioData = {
                                path: btnConfig.audioPath,
                                name: btnConfig.name,
                                audio: audio
                            };
                            button.querySelector('span').textContent = btnConfig.name;
                            button.classList.add('has-audio');
                            setupAudioEvents(button, audio);
                        }
                        if (btnConfig.hotkey) {
                            button.setAttribute('data-hotkey', btnConfig.hotkey);
                            const badge = document.createElement('div');
                            badge.className = 'hotkey-badge';
                            badge.textContent = btnConfig.hotkey;
                            button.appendChild(badge);
                        }
                        grid.appendChild(button);
                    });
                }
                
                // æ·»åŠ "+"æŒ‰é’®
                const addButton = document.createElement('button');
                addButton.className = 'add-sound-button';
                addButton.innerHTML = '+';
                addButton.onclick = () => {
                    const newButton = createButton(category, grid.children.length);
                    grid.insertBefore(newButton, addButton);
                };
                grid.appendChild(addButton);
                
            } catch (err) {
                console.error('Load config error:', err);
                showNotification('åŠ è½½é…ç½®å¤±è´¥', 'error');
            }
        }

        // 2. ç­‰å¾… DOM åŠ è½½å®Œæˆåå†æ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('DOM Content Loaded, initializing...');
            
            // åˆå§‹åŒ–å…¨å±€å˜é‡
            window.currentAudio = null;
            
            try {
                // æ³¨å†Œæ‰€æœ‰å¿«æ·é”®
                await registerAllHotkeys();
                console.log('All hotkeys registered');
                
                // å…¶ä»–åˆå§‹åŒ–ä»£ç ...
            } catch (error) {
                console.error('Error during initialization:', error);
            }

            // é¦–å…ˆè®¾ç½®çª—å£æ§åˆ¶æŒ‰é’®äº‹ä»¶
            const closeButton = document.querySelector('.close-button');
            const minButton = document.querySelector('.min-button');
            
            if (closeButton) {
                closeButton.addEventListener('click', () => {
                    ipcRenderer.send('close-window');  // ç›´æ¥ä½¿ç”¨ ipcRenderer
                });
            }
            
            if (minButton) {
                minButton.addEventListener('click', () => {
                    ipcRenderer.send('minimize-window');  // ç›´æ¥ä½¿ç”¨ ipcRenderer
                });
            }

            // åˆå§‹åŒ–äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.category-tabs .tab-item').forEach(tab => {
                if (tab.id !== 'editTab') {
                    tab.onclick = async () => {
                        document.querySelectorAll('.category-tabs .tab-item').forEach(t => {
                            t.classList.remove('active');
                        });
                        tab.classList.add('active');
                        
                        await loadConfig(tab.textContent);
                    };
                }
            });

            // åˆå§‹åŒ–é»˜è®¤åˆ†ç±»
            const defaultTab = document.querySelector('.category-tabs .tab-item:not(#editTab)');
            if (defaultTab) {
                defaultTab.click();
            }

            // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„ç„¦ç‚¹æ•ˆæœ
            document.addEventListener('mousedown', (e) => {
                if (e.target.closest('.sound-button')) {
                    e.preventDefault();
                    e.target.closest('.sound-button').blur();
                }
            });
            
            // é˜»æ­¢é»˜è®¤çš„ç„¦ç‚¹è¡Œä¸º
            document.addEventListener('click', (e) => {
                if (e.target.closest('.sound-button')) {
                    e.target.closest('.sound-button').blur();
                }
            });

            // å³é”®ç‚¹å‡»å…¶ä»–åœ°æ–¹å…³é—­èœå•
            document.addEventListener('contextmenu', (e) => {
                if (!e.target.closest('.sound-button')) {
                    const menu = document.querySelector('.context-menu');
                    if (menu) {
                        menu.remove();
                    }
                }
            });

            // ä¸ºæŒ‰é’®ç½‘æ ¼æ·»åŠ æ‹–æ”¾åŠŸèƒ½
            const buttonGrid = document.getElementById('buttonGrid');
            if (buttonGrid) {
                buttonGrid.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    buttonGrid.classList.add('dragover');
                });

                buttonGrid.addEventListener('dragleave', (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    buttonGrid.classList.remove('dragover');
                });

                buttonGrid.addEventListener('drop', async (e) => {
                    e.preventDefault();
                    e.stopPropagation();
                    buttonGrid.classList.remove('dragover');

                    // ç¡®ä¿æ‹–æ”¾å‘ç”Ÿåœ¨ç©ºç™½åŒºåŸŸè€Œä¸æ˜¯æŒ‰é’®ä¸Š
                    if (e.target === buttonGrid) {
                        const files = Array.from(e.dataTransfer.files).filter(file => 
                            file.type.startsWith('audio/') || file.name.endsWith('.mp3')
                        );

                        if (files.length > 0) {
                            try {
                                // è·å–å½“å‰åˆ†ç±»
                                const currentCategory = document.querySelector('.category-tabs .tab-item.active').textContent;
                                
                                // ç§»é™¤æ—§çš„æ·»åŠ æŒ‰é’®
                                const addButton = buttonGrid.querySelector('.add-sound-button');
                                if (addButton) {
                                    addButton.remove();
                                }

                                // æ‰¹é‡åˆ›å»ºæŒ‰é’®
                                for (const file of files) {
                                    // åˆ›å»ºæ–°æŒ‰é’®
                                    const newButton = createButton(currentCategory, buttonGrid.children.length);
                                    const textSpan = newButton.querySelector('span');
                                    textSpan.textContent = file.name.replace('.mp3', '');
                                    
                                    // è®¾ç½®éŸ³é¢‘æ•°æ®
                                    const audio = new Audio(file.path);
                                    newButton.audioData = {
                                        path: file.path,
                                        name: file.name.replace('.mp3', ''),
                                        audio: audio
                                    };
                                    
                                    setupAudioEvents(newButton, audio);
                                    newButton.classList.add('has-audio');
                                    
                                    // æ·»åŠ æ–°æŒ‰é’®
                                    buttonGrid.appendChild(newButton);
                                }
                                
                                // é‡æ–°æ·»åŠ "+"æŒ‰é’®
                                if (addButton) {
                                    buttonGrid.appendChild(addButton);
                                }
                                
                                // ä¿å­˜é…ç½®
                                await saveConfig();

                                // æ˜¾ç¤ºæˆåŠŸé€šçŸ¥
                                if (files.length === 1) {
                                    showNotification('éŸ³æ•ˆæ·»åŠ æˆåŠŸï¼', 'success');
                                } else {
                                    showNotification(`æˆåŠŸæ·»åŠ  ${files.length} ä¸ªéŸ³æ•ˆ`, 'success');
                                }
                                
                            } catch (err) {
                                console.error('Error adding audio files:', err);
                                showNotification('æ·»åŠ éŸ³æ•ˆå¤±è´¥ï¼Œè¯·é‡è¯•', 'error');
                            }
                        } else {
                            showNotification('è¯·æ‹–æ”¾éŸ³é¢‘æ–‡ä»¶', 'info');
                        }
                    }
                });
            }

            // æ·»åŠ åœæ­¢æŒ‰é’®äº‹ä»¶ç›‘å¬
            const stopButton = document.querySelector('.stop-button');
            if (stopButton) {
                stopButton.addEventListener('click', () => {
                    if (window.currentAudio) {
                        window.currentAudio.pause();
                        window.currentAudio.currentTime = 0;
                        window.currentAudio = null;

                        // ç§»é™¤æ‰€æœ‰æŒ‰é’®çš„æ’­æ”¾çŠ¶æ€
                        document.querySelectorAll('.sound-button.playing').forEach(btn => {
                            btn.classList.remove('playing');
                        });

                        // é‡ç½®è¿›åº¦æ¡
                        const bottomBar = document.querySelector('.bottom-bar');
                        if (bottomBar) {
                            bottomBar.style.setProperty('--progress', '0%');
                        }

                        // é‡ç½®æ—¶é—´æ˜¾ç¤º
                        const timeDisplay = document.querySelector('.time-display');
                        if (timeDisplay) {
                            timeDisplay.textContent = '00:00 / 00:00';
                        }

                        // é‡ç½®å½“å‰æ’­æ”¾æ˜¾ç¤º
                        const currentPlayingSpan = document.querySelector('.playback-controls span');
                        if (currentPlayingSpan) {
                            currentPlayingSpan.textContent = 'å½“å‰æ’­æ”¾: æ— ';
                        }
                    }
                });
            }
        });

        // æ·»åŠ å¿«æ·é”®ç›¸å…³å‡½æ•° - ç§»åˆ°å‰é¢æ¥
        function showHotkeyDialog(button) {
            console.log('Showing hotkey dialog...');
            const dialog = document.getElementById('hotkeyDialog');
            if (!dialog) {
                console.error('Dialog element not found!');
                return;
            }
            
            const display = document.getElementById('currentHotkey');
            const confirmBtn = document.getElementById('confirmHotkey');
            const cancelBtn = document.getElementById('cancelHotkey');
            let currentHotkey = '';
            
            dialog.style.display = 'flex';
            display.textContent = 'æŒ‰ä¸‹æŒ‰é”®...';
            
            function handleKeyDown(e) {
                e.preventDefault();
                
                const keys = [];
                if (e.ctrlKey) keys.push('Ctrl');
                if (e.shiftKey) keys.push('Shift');
                if (e.altKey) keys.push('Alt');
                
                if (!['Control', 'Shift', 'Alt'].includes(e.key)) {
                    keys.push(e.key.toUpperCase());
                }
                
                currentHotkey = keys.join('+');
                display.textContent = currentHotkey;
            }
            
            document.addEventListener('keydown', handleKeyDown);
            
            confirmBtn.onclick = () => {
                if (currentHotkey) {
                    setHotkey(button, currentHotkey); // ç§»é™¤è¿™é‡Œçš„é€šçŸ¥ï¼Œåªä¿ç•™ setHotkey ä¸­çš„é€šçŸ¥
                }
                cleanup();
            };
            
            cancelBtn.onclick = cleanup;
            
            function cleanup() {
                dialog.style.display = 'none';
                document.removeEventListener('keydown', handleKeyDown);
            }
        }

        // ä¿®æ”¹ setHotkey å‡½æ•°
        async function setHotkey(button, hotkey) {
            try {
                // è½¬æ¢å¿«æ·é”®æ ¼å¼ä¸º Electron æ”¯æŒçš„æ ¼å¼
                const electronHotkey = hotkey
                    .replace('Ctrl', 'CommandOrControl')
                    .replace(/\+/g, '+');
                    
                // æ³¨å†Œå…¨å±€å¿«æ·é”®
                const success = await ipcRenderer.invoke('register-hotkey', {
                    hotkey: electronHotkey,
                    buttonId: button.id
                });

                if (success) {
                    // ç§»é™¤å…¶ä»–æŒ‰é’®ä¸Šçš„ç›¸åŒå¿«æ·é”®
                    document.querySelectorAll('.sound-button').forEach(btn => {
                        if (btn.getAttribute('data-hotkey') === hotkey) {
                            removeHotkey(btn);
                        }
                    });
                    
                    button.setAttribute('data-hotkey', hotkey);
                    
                    // æ›´æ–°æˆ–æ·»åŠ å¿«æ·é”®æ˜¾ç¤º
                    let badge = button.querySelector('.hotkey-badge');
                    if (!badge) {
                        badge = document.createElement('div');
                        badge.className = 'hotkey-badge';
                        button.appendChild(badge);
                    }
                    badge.textContent = hotkey;
                    
                    await saveConfig();
                    showNotification('å¿«æ·é”®è®¾ç½®æˆåŠŸ', 'success');
                } else {
                    showNotification('å¿«æ·é”®æ³¨å†Œå¤±è´¥ï¼Œå¯èƒ½å·²è¢«å ç”¨', 'error');
                }
            } catch (error) {
                console.error('Error setting hotkey:', error);
                showNotification('å¿«æ·é”®è®¾ç½®å¤±è´¥', 'error');
            }
        }

        // ä¿®æ”¹ removeHotkey å‡½æ•°
        async function removeHotkey(button) {
            const hotkey = button.getAttribute('data-hotkey');
            if (hotkey) {
                const electronHotkey = hotkey
                    .replace('Ctrl', 'CommandOrControl')
                    .replace(/\+/g, '+');
                    
                await ipcRenderer.invoke('unregister-hotkey', electronHotkey);
            }
            
            button.removeAttribute('data-hotkey');
            const badge = button.querySelector('.hotkey-badge');
            if (badge) {
                badge.remove();
            }
            await saveConfig();
            showNotification('å¿«æ·é”®å·²æ¸…é™¤', 'success');
        }

        // ç›´æ¥è®¾ç½®ä¸º window çš„å±æ€§ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ let å£°æ˜
        window.audioControl = null;
        window.debounceControl = null;

        // ç­‰å¾… DOM åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('DOM Content Loaded, initializing...');
            
            // åˆå§‹åŒ–å…¨å±€å˜é‡
            window.currentAudio = null;
            
            try {
                // æ³¨å†Œæ‰€æœ‰å¿«æ·é”®
                await registerAllHotkeys();
                console.log('All hotkeys registered');
                
                // å…¶ä»–åˆå§‹åŒ–ä»£ç ...
            } catch (error) {
                console.error('Error during initialization:', error);
            }

            // åˆå§‹åŒ–éŸ³é¢‘æ§åˆ¶å¯¹è±¡
            window.audioControl = {
                currentAudio: null,
                stopAllAudio() {
                    if (this.currentAudio) {
                        this.currentAudio.pause();
                        this.currentAudio.currentTime = 0;
                        this.currentAudio = null;
                    }
                    if (window.currentAudio) {
                        window.currentAudio.pause();
                        window.currentAudio.currentTime = 0;
                        window.currentAudio = null;
                    }
                    document.querySelectorAll('.sound-button.playing').forEach(btn => {
                        btn.classList.remove('playing');
                    });
                },
                play(audioPath) {
                    this.stopAllAudio();
                    const audio = new Audio(audioPath);
                    this.currentAudio = audio;
                    audio.play();
                    audio.onended = () => {
                        if (this.currentAudio === audio) {
                            this.currentAudio = null;
                        }
                    };
                }
            };

            window.debounceControl = {
                lastTriggerTime: {},
                minInterval: 300,
                isAllowed(hotkey) {
                    const now = Date.now();
                    const lastTime = this.lastTriggerTime[hotkey] || 0;
                    if (now - lastTime >= this.minInterval) {
                        this.lastTriggerTime[hotkey] = now;
                        return true;
                    }
                    return false;
                }
            };

            window.currentAudio = null;
            
            // æ³¨å†Œæ‰€æœ‰å¿«æ·é”®
            await registerAllHotkeys();
            
            // çª—å£æ§åˆ¶
            const closeButton = document.querySelector('.close-button');
            const minButton = document.querySelector('.min-button');
            
            if (closeButton) {
                closeButton.addEventListener('click', () => {
                    ipcRenderer.send('close-window');
                });
            }
            
            if (minButton) {
                minButton.addEventListener('click', () => {
                    ipcRenderer.send('minimize-window');
                });
            }

            // åˆå§‹åŒ–é»˜è®¤åˆ†ç±»
            const defaultTab = document.querySelector('.category-tabs .tab-item:not(#editTab)');
            if (defaultTab) {
                defaultTab.click();
            }
        });

        // æ³¨å†Œæ‰€æœ‰å¿«æ·é”®å‡½æ•°
        async function registerAllHotkeys() {
            try {
                console.log('Starting to register all hotkeys...');
                const config = await ipcRenderer.invoke('load-config');
                if (config && config.buttons) {
                    // å…ˆæ³¨é”€æ‰€æœ‰ç°æœ‰çš„å¿«æ·é”®
                    await ipcRenderer.invoke('unregister-all-hotkeys');
                    
                    // é‡æ–°æ³¨å†Œæ‰€æœ‰å¿«æ·é”®
                    for (const button of config.buttons) {
                        if (button.hotkey) {
                            const electronHotkey = button.hotkey
                                .replace('Ctrl', 'CommandOrControl')
                                .replace(/\+/g, '+');
                                
                            console.log('Registering hotkey:', electronHotkey, 'for button:', button.id);
                            const success = await ipcRenderer.invoke('register-hotkey', {
                                hotkey: electronHotkey,
                                buttonId: button.id
                            });
                            
                            if (success) {
                                console.log('Successfully registered hotkey:', electronHotkey);
                            } else {
                                console.error('Failed to register hotkey:', electronHotkey);
                            }
                        }
                    }
                }
            } catch (err) {
                console.error('Error registering all hotkeys:', err);
            }
        }

        // ä¿®æ”¹å¿«æ·é”®è§¦å‘äº‹ä»¶å¤„ç†
        ipcRenderer.on('hotkey-triggered', async (event, buttonId) => {
            console.log('Hotkey triggered for button:', buttonId);
            
            try {
                const button = document.getElementById(buttonId);
                if (button && button.audioData && button.audioData.audio) {
                    // ç›´æ¥è§¦å‘æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ï¼Œè¿™æ ·ä¼šä½¿ç”¨å·²ç»è®¾ç½®å¥½çš„ audio å¯¹è±¡
                    button.click();
                } else {
                    // å¦‚æœæŒ‰é’®ä¸åœ¨å½“å‰è§†å›¾ä¸­ï¼Œä»é…ç½®ä¸­æŸ¥æ‰¾
                    const config = await ipcRenderer.invoke('load-config');
                    if (config && config.buttons) {
                        const buttonConfig = config.buttons.find(btn => btn.id === buttonId);
                        if (buttonConfig && buttonConfig.audioPath) {
                            // åˆ›å»ºæ–°çš„éŸ³é¢‘å¯¹è±¡å¹¶è®¾ç½®æ­£ç¡®çš„è¾“å‡ºè®¾å¤‡
                            const audio = new Audio(buttonConfig.audioPath);
                            
                            // åœ¨æ’­æ”¾å‰è®¾ç½®è¾“å‡ºè®¾å¤‡
                            if (window.selectedAudioOutput && audio.setSinkId) {
                                await audio.setSinkId(window.selectedAudioOutput);
                            }

                            if (window.currentAudio) {
                                window.currentAudio.pause();
                                window.currentAudio.currentTime = 0;
                            }
                            
                            await audio.play();
                            window.currentAudio = audio;

                            // æ›´æ–°å½“å‰æ’­æ”¾æ˜¾ç¤º
                            const currentPlayingSpan = document.querySelector('.playback-controls span');
                            if (currentPlayingSpan) {
                                currentPlayingSpan.textContent = `å½“å‰æ’­æ”¾: ${buttonConfig.name || 'æœªå‘½å'}`;
                            }

                            // è®¾ç½®éŸ³é¢‘ç»“æŸäº‹ä»¶
                            audio.onended = () => {
                                // é‡ç½®å½“å‰æ’­æ”¾æ˜¾ç¤º
                                if (currentPlayingSpan) {
                                    currentPlayingSpan.textContent = 'å½“å‰æ’­æ”¾: æ— ';
                                }
                            };
                        }
                    }
                }
            } catch (error) {
                console.error('Error handling hotkey:', error);
            }
        });

        // åœ¨ DOMContentLoaded äº‹ä»¶ä¸­æ³¨å†Œå¿«æ·é”®
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                console.log('Initializing hotkeys...');
                await registerAllHotkeys();
                console.log('Hotkeys initialized');
            } catch (error) {
                console.error('Error initializing hotkeys:', error);
            }
        });

        // å¤„ç†è®¾ç½®é¡¹å˜åŒ–
        document.getElementById('showProgress').addEventListener('change', (e) => {
            const bottomBar = document.querySelector('.bottom-bar');
            if (bottomBar) {
                bottomBar.style.setProperty('--progress-visible', e.target.checked ? '1' : '0');
            }
        });

        document.getElementById('themeColor').addEventListener('change', (e) => {
            document.documentElement.style.setProperty('--theme-color', e.target.value);
        });

        // åœ¨æ’­æ”¾éŸ³æ•ˆå‰æ£€æŸ¥é…·ç‹—çŠ¶æ€
        async function handleAudioPlay(audio) {
            console.log('Audio play triggered');
            
            try {
                const isKugouPlaying = await window.electronAPI.checkKugouStatus();
                console.log('Kugou status check result:', isKugouPlaying);
                
                if (isKugouPlaying) {
                    console.log('Kugou is playing, attempting to control...');
                    const controlType = localStorage.getItem('audioControl') || 'none';
                    console.log('Control type:', controlType);
                    
                    if (controlType !== 'none' && window.electronAPI) {
                        console.log('Sending control command...');
                        window.electronAPI.controlAudio(controlType);
                    }
                } else {
                    console.log('Kugou is not playing or not found');
                }
            } catch (error) {
                console.error('Error checking Kugou status:', error);
            }
        }

        // ç¡®ä¿éŸ³é¢‘äº‹ä»¶ç›‘å¬å™¨è¢«æ­£ç¡®æ·»åŠ 
        function setupAudioControls(audio) {
            console.log('Setting up audio controls');
            audio.addEventListener('play', () => {
                console.log('Audio play event triggered');
                handleAudioPlay(audio);
            });
        }

        // æµ‹è¯•å‡½æ•°
        async function testKugouStatus() {
            console.log('Testing Kugou status...');
            const status = await window.electronAPI.checkKugouStatus();
            console.log('Kugou status:', status);
        }

        // æ·»åŠ æµ‹è¯•æŒ‰é’®åˆ°è®¾ç½®é¡µé¢
        document.querySelector('.settings-group').insertAdjacentHTML('beforeend', `
            <div class="settings-item">
                <button onclick="testKugouStatus()">æµ‹è¯•é…·ç‹—çŠ¶æ€</button>
            </div>
        `);

        // æ·»åŠ æµ‹è¯•æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶
        document.getElementById('testKugou')?.addEventListener('click', async () => {
            console.log('Testing Kugou status...');
            const status = await window.electronAPI.checkKugouStatus();
            console.log('Kugou status:', status);
            alert('é…·ç‹—çŠ¶æ€: ' + (status ? 'æ­£åœ¨æ’­æ”¾' : 'æœªæ’­æ”¾'));
        });

        // æ·»åŠ é€šçŸ¥ç³»ç»Ÿ
        function showNotification(message, type = 'info', duration = 2000) {
            const container = document.getElementById('notificationContainer');
            if (!container) return;
            
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            container.appendChild(notification);
            
            requestAnimationFrame(() => {
                notification.classList.add('show');
            });
            
            setTimeout(() => {
                notification.classList.add('hide');
                notification.addEventListener('animationend', () => {
                    notification.remove();
                });
            }, duration);
        }

        // æ·»åŠ å¿«æ·é”®ç›¸å…³å‡½æ•°
        function showHotkeyDialog(button) {
            console.log('Showing hotkey dialog...');
            const dialog = document.getElementById('hotkeyDialog');
            if (!dialog) {
                console.error('Dialog element not found!');
                return;
            }
            
            const display = document.getElementById('currentHotkey');
            const confirmBtn = document.getElementById('confirmHotkey');
            const cancelBtn = document.getElementById('cancelHotkey');
            let currentHotkey = '';
            
            dialog.style.display = 'flex';
            display.textContent = 'æŒ‰ä¸‹æŒ‰é”®...';
            
            function handleKeyDown(e) {
                e.preventDefault();
                
                const keys = [];
                if (e.ctrlKey) keys.push('Ctrl');
                if (e.shiftKey) keys.push('Shift');
                if (e.altKey) keys.push('Alt');
                
                if (!['Control', 'Shift', 'Alt'].includes(e.key)) {
                    keys.push(e.key.toUpperCase());
                }
                
                currentHotkey = keys.join('+');
                display.textContent = currentHotkey;
            }
            
            document.addEventListener('keydown', handleKeyDown);
            
            confirmBtn.onclick = () => {
                if (currentHotkey) {
                    setHotkey(button, currentHotkey); // ç§»é™¤è¿™é‡Œçš„é€šçŸ¥ï¼Œåªä¿ç•™ setHotkey ä¸­çš„é€šçŸ¥
                }
                cleanup();
            };
            
            cancelBtn.onclick = cleanup;
            
            function cleanup() {
                dialog.style.display = 'none';
                document.removeEventListener('keydown', handleKeyDown);
            }
        }

        // ä¿®æ”¹ setHotkey å‡½æ•°
        async function setHotkey(button, hotkey) {
            try {
                // è½¬æ¢å¿«æ·é”®æ ¼å¼ä¸º Electron æ”¯æŒçš„æ ¼å¼
                const electronHotkey = hotkey
                    .replace('Ctrl', 'CommandOrControl')
                    .replace(/\+/g, '+');
                    
                // æ³¨å†Œå…¨å±€å¿«æ·é”®
                const success = await ipcRenderer.invoke('register-hotkey', {
                    hotkey: electronHotkey,
                    buttonId: button.id
                });

                if (success) {
                    // ç§»é™¤å…¶ä»–æŒ‰é’®ä¸Šçš„ç›¸åŒå¿«æ·é”®
                    document.querySelectorAll('.sound-button').forEach(btn => {
                        if (btn.getAttribute('data-hotkey') === hotkey) {
                            removeHotkey(btn);
                        }
                    });
                    
                    button.setAttribute('data-hotkey', hotkey);
                    
                    // æ›´æ–°æˆ–æ·»åŠ å¿«æ·é”®æ˜¾ç¤º
                    let badge = button.querySelector('.hotkey-badge');
                    if (!badge) {
                        badge = document.createElement('div');
                        badge.className = 'hotkey-badge';
                        button.appendChild(badge);
                    }
                    badge.textContent = hotkey;
                    
                    await saveConfig();
                    showNotification('å…¨å±€å¿«æ·é”®è®¾ç½®æˆåŠŸ', 'success');
                } else {
                    showNotification('å¿«æ·é”®æ³¨å†Œå¤±è´¥ï¼Œå¯èƒ½å·²è¢«å ç”¨', 'error');
                }
            } catch (error) {
                console.error('Error setting hotkey:', error);
                showNotification('å¿«æ·é”®è®¾ç½®å¤±è´¥', 'error');
            }
        }

        // ä¿®æ”¹ removeHotkey å‡½æ•°
        async function removeHotkey(button) {
            const hotkey = button.getAttribute('data-hotkey');
            if (hotkey) {
                const electronHotkey = hotkey
                    .replace('Ctrl', 'CommandOrControl')
                    .replace(/\+/g, '+');
                    
                await ipcRenderer.invoke('unregister-hotkey', electronHotkey);
            }
            
            button.removeAttribute('data-hotkey');
            const badge = button.querySelector('.hotkey-badge');
            if (badge) {
                badge.remove();
            }
            await saveConfig();
            showNotification('å¿«æ·é”®å·²æ¸…é™¤', 'success');
        }

        // åœ¨ç°æœ‰çš„ DOMContentLoaded äº‹ä»¶ç›‘å¬å™¨ä¸­æ·»åŠ 
        document.addEventListener('DOMContentLoaded', async () => {
            // ... å…¶ä»–åˆå§‹åŒ–ä»£ç  ...
            
            // åˆå§‹åŒ–éŸ³é¢‘è¾“å‡ºè®¾å¤‡é€‰æ‹©
            await initAudioOutputs();
        });

        // æ·»åŠ æ—¶é—´æ ¼å¼åŒ–å‡½æ•°
        function formatTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainingSeconds = Math.floor(seconds % 60);
            return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
        }
    </script>
    <style>
@layer base {
    .sound-button {
        -webkit-tap-highlight-color: transparent !important;
        -webkit-user-drag: none;
        -webkit-user-select: none;
        user-select: none;
    }

    .sound-button::after {
        display: none !important;
    }

    .sound-button::before {
        -webkit-user-drag: none;
        user-select: none;
    }
}

        :root {
            --base-size: min(2vh, 16px);
            --padding: calc(var(--base-size) * 1.5);
        }

        body {
            margin: 0;
            padding: 0;
            font-family: system-ui;
            background: transparent !important;
        }

        .app-container {
            width: 100%;
            height: 100vh;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2),  /* ä¸»é˜´å½± */
                        0 8px 24px rgba(0, 0, 0, 0.15),  /* ä¸­ç­‰èŒƒå›´é˜´å½± */
                        0 16px 48px rgba(0, 0, 0, 0.1);  /* å¤§èŒƒå›´æŸ”å’Œé˜´å½± */
        }

        /* æ ‡é¢˜æ æ ·å¼ */
        .title-bar {
            -webkit-app-region: drag;
            height: 45px;  /* æ ‡å‡†é«˜åº¦ */
            background: #3498ff !important;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            color: white;
        }

        /* å·¦ä¾§èœå• */
        .left-menu {
            width: 60px;
            background: #f8f9fa;
            border-right: 1px solid #eaeaea;
            display: flex;
            flex-direction: column;
        }

        .menu-item {
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #666;
        }

        .menu-item:hover {
            background: #e9ecef;
        }

        /* ä¸»å†…å®¹åŒº */
        .main-content {
            flex: 1;
            display: flex;
            min-height: 0; /* é˜²æ­¢å†…å®¹æº¢å‡º */
        }

        /* åˆ†ç±»æ ‡ç­¾æ  */
        .category-tabs {
            height: 48px;
            background: #ffffff;
            display: flex;
            align-items: center;
            padding: 0 20px;
            gap: 8px;
            border-bottom: 1px solid #eaeaea;
            overflow-x: auto;
            scrollbar-width: none; /* Firefox */
            -ms-overflow-style: none; /* IE and Edge */
            user-select: none; /* é˜²æ­¢æ‹–åŠ¨æ—¶é€‰ä¸­æ–‡å­— */
        }

        .category-tabs::-webkit-scrollbar {
            display: none; /* Chrome, Safari, Opera */
        }

        /* åˆ†ç±»æ ‡ç­¾åŸºç¡€æ ·å¼ */
        .tab-item {
            position: relative;
            display: inline-flex !important;
            align-items: center;
            padding: 6px 12px !important;
            border-radius: 20px;
            background: #fff;
            border: none;
            margin: 0 4px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            border-bottom: none !important;
        }

        /* åˆ†ç±»åç§°æ ·å¼ */
        .category-name {
            flex: 1;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            text-align: center;
            max-width: calc(100% - 45px); /* ä¸ºæ“ä½œæŒ‰é’®é¢„ç•™ç©ºé—´ */
        }

        /* æ“ä½œæŒ‰é’®å®¹å™¨ */
        .action-buttons {
            display: none;
            align-items: center;
            gap: 2px;
            margin-left: 4px;
        }

        .tab-item.edit-mode .action-buttons {
            display: inline-flex;
        }

        /* ç¼–è¾‘å’Œåˆ é™¤æŒ‰é’® */
        .edit-btn, .delete-btn {
            width: 14px;
            height: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s ease;
            font-size: 12px;
        }

        .edit-btn {
            color: #2196F3;
        }

        .delete-btn {
            color: #ff4444;
        }

        .edit-btn:hover, .delete-btn:hover {
            opacity: 1;
        }

        .tab-item:hover {
            border-bottom: none !important;
        }

        .tab-item.active {
            border-bottom: none !important;
        }

        .tab-item.active:hover {
            border-bottom: none !important;
        }

        .tab-item.dragging {
            opacity: 0.5;
            background: #e3f2fd;
        }

        /* ç¼–è¾‘æŒ‰é’®ç‰¹æ®Šæ ·å¼ */
        #editTab {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px dashed #4caf50;
        }

        #editTab:hover {
            background: #c8e6c9;
            border-style: solid;
        }

        /* åˆ›å»ºåˆ†ç±»å¯¹è¯æ¡†æ ·å¼ */
        #createCategoryDialog {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.12);
            min-width: 300px;
        }

        #createCategoryDialog h3 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 18px;
            font-weight: 500;
        }

        #newCategoryInput {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.2s ease;
            margin-bottom: 20px;
            box-sizing: border-box;
        }

        #newCategoryInput:focus {
            outline: none;
            border-color: #2196F3;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .dialog-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        #cancelCreate, #confirmCreate {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
        }

        #cancelCreate {
            background: #f5f5f5;
            color: #666;
        }

        #cancelCreate:hover {
            background: #e0e0e0;
        }

        #confirmCreate {
            background: #2196F3;
            color: white;
        }

        #confirmCreate:hover {
            background: #1976D2;
            box-shadow: 0 2px 4px rgba(33, 150, 243, 0.2);
        }

        /* æ·»åŠ é®ç½©å±‚ */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000; /* ç¡®ä¿æ¯”å…¶ä»–å…ƒç´ éƒ½é«˜ */
            backdrop-filter: blur(4px);
        }

        .dialog-content {
            background: white;
            padding: 24px;
            border-radius: 12px;
            min-width: 300px;
            text-align: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .dialog-content h3 {
            margin: 0 0 8px 0;
            color: #333;
        }

        .dialog-content p {
            margin: 0 0 16px 0;
            color: #666;
            font-size: 14px;
        }

        .hotkey-display {
            margin: 20px 0;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: monospace;
            font-size: 16px;
            min-height: 20px;
            background: #f5f5f5;
        }

        .dialog-buttons {
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            margin-top: 24px;
        }

        .dialog-buttons button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        #cancelHotkey {
            background: #f5f5f5;
            color: #333;
        }

        #confirmHotkey {
            background: #2196f3;
            color: white;
        }

        #cancelHotkey:hover {
            background: #e0e0e0;
        }

        #confirmHotkey:hover {
            background: #1976d2;
        }

        /* æŒ‰é’®ä¸Šçš„å¿«æ·é”®æ˜¾ç¤º */
        .hotkey-badge {
            position: absolute;
            top: 4px;
            right: 4px;
            background: rgba(0, 0, 0, 0.6);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
        }

        /* æŒ‰é’®ç½‘æ ¼æ ·å¼ */
        .button-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            padding: 20px;
            flex: 1;
            overflow-y: auto;
            min-height: 0;
            grid-auto-rows: min-content;
            align-content: start;
        }

        /* æŒ‰é’®æ ·å¼ä¼˜åŒ– */
        .sound-button {
            height: 56px;
            background: #ffffff;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: var(--base-size);
            user-select: none;
            position: relative;
            outline: none;
            transition: all 0.2s ease;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* å†…å®¹åŒºåŸŸ */
        .sound-button span {
            color: #333;
            padding: 0 16px;
            text-align: center;
            font-weight: 500;
        }

        /* æ‚¬åœæ•ˆæœ */
        .sound-button:hover {
            background: #f8f9fa;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.08);
        }

        /* ç‚¹å‡»æ•ˆæœ */
        .sound-button:active {
            transform: translateY(0);
            background: #f1f3f5;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }

        /* æ’­æ”¾ä¸­çš„æŒ‰é’®æ ·å¼ */
        .sound-button.playing {
            background: #e3f2fd;
            border-color: #2196F3;
            color: #1976D2;
        }

        /* å·²æœ‰éŸ³é¢‘çš„æŒ‰é’®æ ·å¼ */
        .sound-button.has-audio {
            background: #fff;
            border-color: #2196F3;
            color: #1976D2;
        }

        /* ç§»é™¤æ‰€æœ‰çŠ¶æ€çš„æ•ˆæœ */
        .sound-button:focus,
        .sound-button:active,
        .sound-button:hover,
        .sound-button *:focus,
        .sound-button *:active,
        .sound-button *:hover {
            outline: none !important;
            -webkit-tap-highlight-color: transparent;
        }

        /* åº•éƒ¨æ§åˆ¶æ  */
        .bottom-bar {
            height: 45px;
            background: #3498ff !important;
            color: white;
            display: flex;
            align-items: center;
            padding: 0 15px;
            justify-content: space-between;
            position: relative;
            overflow: hidden;
            opacity: 1 !important;
            flex-shrink: 0; /* é˜²æ­¢åº•éƒ¨æ è¢«å‹ç¼© */
        }

        /* ä¿®æ”¹åº•éƒ¨è¿›åº¦æ¡é¢œè‰²ï¼Œä½¿å…¶ä¸æ–°çš„è“è‰²æ­é… */
        .bottom-bar::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: var(--progress, 0%);
            height: 3px;
            background: rgba(255, 255, 255, 0.9) !important;
            transition: width 0.1s linear;
        }

        /* ä¿®æ”¹åº•éƒ¨è¿›åº¦æ¡åŠ¨ç”»é¢œè‰² */
        .bottom-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: var(--progress, 0%);
            height: 3px;
            background: linear-gradient(
                90deg,
                #3498ff,
                #ffffff,
                #3498ff
            );
            animation: slide 1.5s linear infinite;
        }

        @keyframes slide {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }

        /* æ’­æ”¾æ§åˆ¶åŒºåŸŸæ ·å¼ */
        .playback-controls {
            display: flex;
            align-items: center;
            justify-content: space-between; /* ä¸¤ç«¯å¯¹é½ */
            width: 100%;
            height: 100%;
            padding: 0 15px;
        }

        /* å·¦ä¾§æ’­æ”¾ä¿¡æ¯ */
        .playback-info {
            flex: 0 1 auto;
        }

        .playback-info span {
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 300px;
            color: white;
            font-size: 12px; /* å’Œæ—¶é—´æ˜¾ç¤ºä¸€æ ·çš„å­—ä½“å¤§å° */
            font-family: monospace; /* å¯é€‰ï¼šä½¿ç”¨ç­‰å®½å­—ä½“ï¼Œå’Œæ—¶é—´æ˜¾ç¤ºä¿æŒä¸€è‡´ */
        }

        /* å³ä¾§æ§åˆ¶å…ƒç´ å®¹å™¨ */
        .control-elements {
            display: flex;
            align-items: center;
            gap: 20px; /* æ§åˆ¶å…ƒç´ ä¹‹é—´çš„é—´è· */
            margin-left: auto; /* æ¨åˆ°å³è¾¹ */
        }

        /* åœæ­¢æŒ‰é’® */
        .stop-button {
            padding: 4px 12px;
            height: 24px;
            line-height: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            color: white;
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px;
        }

        /* æ—¶é—´æ˜¾ç¤º */
        .time-display {
            font-family: monospace;
            font-size: 12px;
            color: white;
            min-width: 90px;
            text-align: center;
        }

        /* éŸ³é¢‘è¾“å‡ºæ§åˆ¶ */
        .audio-output-control {
            min-width: 150px;
        }

        .audio-output-select {
            width: 100%;
            padding: 4px 8px;
            height: 24px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 3px;
            color: white;
            font-size: 12px;
            cursor: pointer;
        }

        .channel-select {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 2px 5px; /* å‡å°å†…è¾¹è· */
            border-radius: 3px; /* å‡å°åœ†è§’ */
            cursor: pointer;
            transition: all 0.2s ease;
            font-size: 12px; /* å‡å°å­—ä½“å¤§å° */
            height: 24px; /* é€‚å½“å¢åŠ é«˜åº¦ */
            line-height: 24px; /* æ–‡å­—å‚ç›´å±…ä¸­ */
        }

        .channel-select:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* çª—å£æ§åˆ¶æŒ‰é’®æ ·å¼ä¼˜åŒ– */
        .window-controls {
            -webkit-app-region: no-drag;
        }

        .window-controls button {
            background: none;
            border: none;
            color: white;
            font-size: 18px;
            cursor: pointer;
            padding: 5px 10px;
            transition: all 0.2s ease;
            border-radius: 4px;
        }

        .window-controls button:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .window-controls button:active {
            transform: scale(0.95);
            background: rgba(255, 255, 255, 0.2);
        }

        /* ç¼–è¾‘æ¨¡å¼çš„æ™ƒåŠ¨åŠ¨ç”» */
        @keyframes wiggle {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-1deg); }
            75% { transform: rotate(1deg); }
            100% { transform: rotate(0deg); }
        }

        /* ç¼–è¾‘æ¨¡å¼çš„æ ‡ç­¾æ ·å¼ */
        .tab-item.edit-mode {
            animation: wiggle 0.6s infinite;
            cursor: move;
            padding-left: 24px; /* ä¸ºåˆ é™¤æŒ‰é’®ç•™å‡ºç©ºé—´ */
            position: relative;
        }

        /* åˆ é™¤æŒ‰é’®æ ·å¼ */
        .delete-badge {
            position: absolute;
            left: 4px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background: #ff4444;
            border-radius: 50%;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            z-index: 1;
        }

        .tab-item.edit-mode .delete-badge {
            display: flex;
        }

        /* ç¼–è¾‘æŒ‰é’®æ¿€æ´»çŠ¶æ€ */
        #editTab.active {
            background: #4caf50;
            color: white;
            border: none;
        }

        /* ç¼–è¾‘æ¨¡å¼æ ·å¼ */
        .tab-item.edit-mode {
            animation: wiggle 0.6s infinite;
            cursor: move;
            padding-left: 24px;
        }

        @keyframes wiggle {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-1deg); }
            75% { transform: rotate(1deg); }
            100% { transform: rotate(0deg); }
        }

        /* æ·»åŠ åˆ†ç±»æŒ‰é’®æ ·å¼ä¼˜åŒ– */
        .add-category {
            background: #e8f5e9 !important;
            color: #4caf50 !important;
            font-size: 20px !important;
            width: 32px;
            height: 32px;
            padding: 0 !important;
            display: flex !important;
            align-items: center;
            justify-content: center;
            border-radius: 16px !important;
            margin-left: 8px !important;
            animation: none !important; /* é˜²æ­¢ç»§æ‰¿ç¼–è¾‘æ¨¡å¼çš„æ™ƒåŠ¨æ•ˆæœ */
            cursor: pointer !important;
        }

        .add-category:hover {
            background: #c8e6c9 !important;
            transform: scale(1.1);
        }

        /* ç¼–è¾‘æ¨¡å¼æ ·å¼ */
        .tab-item.edit-mode {
            animation: wiggle 0.6s infinite;
            cursor: move;
            padding-left: 24px;
            position: relative;
        }

        /* é»˜è®¤åˆ†ç±»ç‰¹æ®Šæ ·å¼ */
        .tab-item.edit-mode.default-category {
            padding-left: 12px; /* é»˜è®¤åˆ†ç±»ä¸éœ€è¦åˆ é™¤æŒ‰é’®çš„ç©ºé—´ */
        }

        @keyframes wiggle {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-1deg); }
            75% { transform: rotate(1deg); }
            100% { transform: rotate(0deg); }
        }

        /* åˆ é™¤æŒ‰é’®æ ·å¼ */
        .delete-badge {
            position: absolute;
            left: 4px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background: #ff4444;
            border-radius: 50%;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: pointer;
            z-index: 1;
        }

        .tab-item.edit-mode:not(.default-category) .delete-badge {
            display: flex;
        }

        #editTab.active {
            background: #4caf50;
            color: white;
        }

        /* ç¼–è¾‘å›¾æ ‡æ ·å¼ä¼˜åŒ– */
        .edit-icon {
            position: absolute;
            right: -5px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background: #2196F3;
            border-radius: 50%;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
            font-size: 12px;
            border: 1.5px solid white;
        }

        /* æ·»åŠ æç¤ºæ–‡å­— */
        .edit-icon:hover::after {
            content: 'ä¿®æ”¹åç§°';
            position: absolute;
            top: -25px;
            right: -10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }

        .edit-icon:hover {
            transform: translateY(-50%) scale(1.1);
            background: #1976D2;
        }

        .tab-item.edit-mode .edit-icon {
            display: flex;
        }

        /* åˆ é™¤å›¾æ ‡æ ·å¼ï¼ˆä»…ç”¨äºç”¨æˆ·åˆ›å»ºçš„åˆ†ç±»ï¼‰ */
        .delete-badge {
            position: absolute;
            left: -5px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            background: #ff4444;
            border-radius: 50%;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
            font-size: 12px;
            border: 1.5px solid white;
        }

        /* ç¼–è¾‘çŠ¶æ€ä¸‹çš„åˆ†ç±»æ ‡ç­¾æ ·å¼ */
        .tab-item.edit-mode {
            position: relative;
            padding-right: 25px !important; /* ä¸ºç¼–è¾‘å›¾æ ‡ç•™å‡ºç©ºé—´ */
        }

        /* ç”¨æˆ·åˆ›å»ºçš„åˆ†ç±»åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹çš„æ ·å¼ */
        .tab-item.edit-mode.user-category {
            padding-left: 25px !important; /* ä¸ºåˆ é™¤å›¾æ ‡ç•™å‡ºç©ºé—´ */
        }

        .tab-item.edit-mode.user-category .delete-badge {
            display: flex;
        }

        /* æ·»åŠ åˆ é™¤æç¤ºæ–‡å­— */
        .delete-badge:hover::after {
            content: 'åˆ é™¤åˆ†ç±»';
            position: absolute;
            top: 24px;
            left: -10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
        }

        .delete-badge:hover {
            transform: scale(1.1);
            background: #ff1744;
        }

        .tab-item.edit-mode .delete-badge {
            display: flex;
        }

        /* ç¼–è¾‘çŠ¶æ€ä¸‹çš„åˆ†ç±»æ ‡ç­¾æ ·å¼ */
        .tab-item.edit-mode {
            position: relative;
            animation: wiggle 1s infinite;
            transform-origin: center center;
        }

        @keyframes wiggle {
            0% { transform: rotate(0deg); }
            25% { transform: rotate(-1deg); }
            75% { transform: rotate(1deg); }
            100% { transform: rotate(0deg); }
        }

        /* ç¼–è¾‘æŒ‰é’®æ¿€æ´»çŠ¶æ€ */
        #editTab.active {
            background: #4caf50;
            color: white;
            position: relative;
        }

        /* æ·»åŠ ç¼–è¾‘æ¨¡å¼æç¤º */
        #editTab.active::after {
            content: 'ç‚¹å‡»é€€å‡ºç¼–è¾‘æ¨¡å¼';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
        }

        #editTab:not(.active)::after {
            content: 'ç‚¹å‡»ç¼–è¾‘åˆ†ç±»';
            position: absolute;
            bottom: -30px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 12px;
            white-space: nowrap;
            z-index: 1000;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
        }

        #editTab:not(.active):hover::after {
            opacity: 1;
        }

        /* é‡å‘½åå¯¹è¯æ¡†æ ·å¼ */
        .rename-dialog {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.12);
            width: 320px;
            position: relative;
        }

        .rename-dialog h3 {
            margin: 0 0 20px 0;
            color: #333;
            font-size: 16px;
            font-weight: 500;
        }

        .rename-input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            margin-bottom: 20px;
            box-sizing: border-box;
            transition: all 0.2s ease;
            background: #f5f5f5;
        }

        .rename-input:focus {
            outline: none;
            border-color: #2196F3;
            background: white;
            box-shadow: 0 0 0 3px rgba(33, 150, 243, 0.1);
        }

        .dialog-buttons {
            display: flex;
            gap: 12px;
            justify-content: flex-end;
        }

        .dialog-button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
        }

        .dialog-button.cancel {
            background: #f5f5f5;
            color: #666;
        }

        .dialog-button.cancel:hover {
            background: #eeeeee;
        }

        .dialog-button.confirm {
            background: #2196F3;
            color: white;
        }

        .dialog-button.confirm:hover {
            background: #1976D2;
        }

        /* é®ç½©å±‚æ ·å¼ */
        .dialog-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(2px);
            animation: fadeIn 0.2s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .rename-dialog {
            animation: slideIn 0.2s ease;
        }

        @keyframes slideIn {
            from {
                transform: translateY(-20px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        /* ç¼–è¾‘æ¨¡å¼ä¸‹çš„åˆ†ç±»æ ‡ç­¾åŸºç¡€æ ·å¼ */
        .tab-item.edit-mode {
            position: relative;
            padding: 6px 12px !important;
        }

        /* ç¼–è¾‘å›¾æ ‡æ ·å¼ä¼˜åŒ– */
        .edit-icon {
            position: absolute;
            right: -4px;
            top: -4px;
            width: 14px;
            height: 14px;
            background: #2196F3;
            border-radius: 50%;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
            font-size: 10px;
            border: 1.5px solid white;
            z-index: 2;
        }

        /* åˆ é™¤å›¾æ ‡æ ·å¼ä¼˜åŒ– */
        .delete-badge {
            position: absolute;
            right: -4px;
            top: -4px;
            width: 14px;
            height: 14px;
            background: #ff4444;
            border-radius: 50%;
            color: white;
            display: none;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            transition: all 0.2s ease;
            font-size: 10px;
            border: 1.5px solid white;
            z-index: 2;
        }

        /* ç¼–è¾‘å›¾æ ‡ä½ç½®è°ƒæ•´ï¼ˆç”¨äºé»˜è®¤åˆ†ç±»ï¼‰ */
        .tab-item.edit-mode:not(.user-category) .edit-icon {
            display: flex;
        }

        /* ç”¨æˆ·åˆ›å»ºçš„åˆ†ç±»ç‰¹æ®Šå¤„ç† */
        .tab-item.edit-mode.user-category .edit-icon {
            right: 12px;
            display: flex;
        }

        .tab-item.edit-mode.user-category .delete-badge {
            display: flex;
        }

        /* æ‚¬åœæ•ˆæœ */
        .edit-icon:hover, .delete-badge:hover {
            transform: scale(1.2);
        }

        /* æç¤ºæ–‡å­—æ ·å¼ */
        .edit-icon:hover::after, .delete-badge:hover::after {
            content: attr(data-tooltip);
            position: absolute;
            top: -25px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 3px 6px;
            border-radius: 3px;
            font-size: 10px;
            white-space: nowrap;
            pointer-events: none;
        }

        /* ç¼–è¾‘æ¨¡å¼ä¸‹çš„åˆ†ç±»æ ‡ç­¾æ ·å¼ */
        .tab-item {
            position: relative;
            transition: all 0.3s ease;
        }

        .tab-item.edit-mode {
            padding-right: 28px !important;
            background: linear-gradient(to right, transparent 80%, rgba(0,0,0,0.05));
        }

        /* æ“ä½œæŒ‰é’®å®¹å™¨ */
        .action-buttons {
            position: absolute;
            right: 8px;
            top: 50%;
            transform: translateY(-50%);
            display: none;
            gap: 6px;
            align-items: center;
        }

        .tab-item.edit-mode .action-buttons {
            display: flex;
        }

        /* ç¼–è¾‘å’Œåˆ é™¤æŒ‰é’® */
        .edit-btn, .delete-btn {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0.6;
            transition: all 0.2s ease;
            color: #666;
            font-size: 14px;
        }

        .edit-btn:hover, .delete-btn:hover {
            opacity: 1;
            color: #333;
        }

        .delete-btn {
            color: #ff4444;
        }

        .delete-btn:hover {
            color: #ff1744;
        }

        /* æ¿€æ´»çŠ¶æ€ */
        .tab-item.active {
            background: #2196F3;
            color: white;
        }

        .tab-item.active .edit-btn,
        .tab-item.active .delete-btn {
            color: white;
        }

        /* é‡ç½®æ‰€æœ‰å¯èƒ½çš„è¾¹æ¡†æ ·å¼ */
        #editTab,
        #editTab *,
        button#editTab,
        button#editTab *,
        .tab-item#editTab,
        .tab-item#editTab * {
            border: 0 !important;
            border-bottom: 0 !important;
            border-width: 0 !important;
            outline: none !important;
            box-shadow: none !important;
            text-decoration: none !important;
        }

        /* å¤„ç†æ‰€æœ‰çŠ¶æ€ */
        #editTab:hover,
        #editTab:focus,
        #editTab:active,
        #editTab.active,
        button#editTab:hover,
        button#editTab:focus,
        button#editTab:active,
        button#editTab.active,
        .tab-item#editTab:hover,
        .tab-item#editTab:focus,
        .tab-item#editTab:active,
        .tab-item#editTab.active {
            border: 0 !important;
            border-bottom: 0 !important;
            border-width: 0 !important;
            outline: none !important;
            box-shadow: none !important;
            text-decoration: none !important;
        }

        /* è¦†ç›–ä»»ä½•å¯èƒ½çš„ä¼ªå…ƒç´  */
        #editTab::before,
        #editTab::after,
        button#editTab::before,
        button#editTab::after,
        .tab-item#editTab::before,
        .tab-item#editTab::after {
            border: 0 !important;
            border-bottom: 0 !important;
            border-width: 0 !important;
            outline: none !important;
            box-shadow: none !important;
            content: none !important;
        }

        /* æ·»åŠ è¿™äº›CSSæ ·å¼ */
        .tab-item {
            position: relative !important;
        }

        .action-buttons {
            position: absolute !important;
            right: 8px !important;
            top: 50% !important;
            transform: translateY(-50%) !important;
            z-index: 999 !important;
            pointer-events: auto !important;
        }

        .edit-btn, .delete-btn {
            position: relative !important;
            z-index: 1000 !important;
            pointer-events: auto !important;
        }

        /* ç§»é™¤æ‰€æœ‰å¯èƒ½çš„ç„¦ç‚¹æ ·å¼ */
        .sound-button:focus,
        .sound-button:active,
        .sound-button span:focus,
        .sound-button span:active {
            outline: none;
            box-shadow: none;
        }

        /* æ·»åŠ åº•éƒ¨æ’­æ”¾æ§åˆ¶æ çš„æ ·å¼ */
        .player-controls {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: #2196F3;
            display: flex;
            align-items: center;
            padding: 0 10px;
            z-index: 1000;
        }

        /* è¿›åº¦æ¡æ•ˆæœ */
        .player-controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: var(--progress, 0%);
            background: rgba(255, 255, 255, 0.1);
            transition: width 0.1s linear;
        }

        /* åº•éƒ¨æ’­æ”¾æ§åˆ¶åŒºåŸŸ */
        #footer {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 40px;
            background: #2196F3;
            display: flex;
            align-items: center;
            padding: 0 10px;
            color: white;
        }

        /* è¿›åº¦æ¡æ•ˆæœ */
        #footer::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            height: 100%;
            width: var(--progress, 0%);
            background: rgba(255, 255, 255, 0.1);
            z-index: 0;
        }

        /* ç¡®ä¿å†…å®¹åœ¨è¿›åº¦æ¡ä¸Šå±‚ */
        #footer > * {
            position: relative;
            z-index: 1;
        }

        /* åº•éƒ¨çŠ¶æ€æ è¿›åº¦æ¡ */
        .status-bar {
            position: relative;
            background: #2196F3;
        }

        .status-bar::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: var(--progress, 0%);
            height: 2px;  /* è¿›åº¦æ¡é«˜åº¦ */
            background: rgba(255, 255, 255, 0.8);  /* ç™½è‰²è¿›åº¦æ¡ */
            transition: width 0.1s linear;
        }

        /* ç¾åŒ–æ»šåŠ¨æ¡æ ·å¼ */
        ::-webkit-scrollbar {
            width: 8px;  /* æ»šåŠ¨æ¡å®½åº¦ */
            height: 8px; /* æ¨ªå‘æ»šåŠ¨æ¡é«˜åº¦ */
        }

        /* æ»šåŠ¨æ¡è½¨é“ */
        ::-webkit-scrollbar-track {
            background: transparent;
            border-radius: 4px;
        }

        /* æ»šåŠ¨æ¡æ»‘å— */
        ::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
            transition: all 0.2s ease;
        }

        /* æ»šåŠ¨æ¡æ»‘å—æ‚¬åœæ•ˆæœ */
        ::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        /* æ»šåŠ¨æ¡æ»‘å—æ¿€æ´»æ•ˆæœ */
        ::-webkit-scrollbar-thumb:active {
            background: rgba(0, 0, 0, 0.4);
        }

        /* æ»šåŠ¨æ¡è§’è½ */
        ::-webkit-scrollbar-corner {
            background: transparent;
        }

        /* ç¡®ä¿æŒ‰é’®ç½‘æ ¼åŒºåŸŸçš„æ»šåŠ¨æ¡æ ·å¼ä¸€è‡´ */
        .button-grid::-webkit-scrollbar {
            width: 8px;
        }

        .button-grid::-webkit-scrollbar-track {
            background: transparent;
            border-radius: 4px;
        }

        .button-grid::-webkit-scrollbar-thumb {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        .button-grid::-webkit-scrollbar-thumb:hover {
            background: rgba(0, 0, 0, 0.3);
        }

        /* æ·»åŠ æŒ‰é’®æ ·å¼ */
        .add-sound-button {
            width: 100%;
            height: 56px;
            background: #f8f9fa;
            border: 2px dashed #e0e0e0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 32px; /* å¢å¤§åŠ å·å¤§å° */
            color: #999;
            transition: all 0.2s ease;
            grid-column: span 1; /* ç¡®ä¿æŒ‰é’®å æ®ä¸€ä¸ªç½‘æ ¼å•å…ƒæ ¼ */
        }

        .add-sound-button:hover {
            background: #fff;
            border-color: #3498ff;
            color: #3498ff;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(52, 152, 255, 0.1);
        }

        .add-sound-button:active {
            transform: translateY(0);
        }

        /* ç©ºç™½æŒ‰é’®æ ·å¼ */
        .sound-button:not(.has-audio) {
            border: 1px solid #e0e0e0;
            background: #f8f9fa;
        }

        .sound-button:not(.has-audio):hover {
            border-color: #3498ff;
            background: #fff;
        }

        /* å³é”®èœå•æ ·å¼ */
        .context-menu {
            position: fixed;
            background: rgba(255, 255, 255, 0.98);
            border-radius: 8px;
            padding: 4px;
            min-width: 160px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .context-menu-item {
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            color: #333;
            transition: all 0.2s ease;
            border-radius: 4px;
            font-size: 13px;
        }

        .context-menu-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .menu-icon {
            font-size: 16px;
            opacity: 0.8;
        }

        /* åˆ é™¤ç›¸å…³çš„èœå•é¡¹ç‰¹æ®Šæ ·å¼ */
        .context-menu-item:nth-child(3),
        .context-menu-item:nth-child(4) {
            color: #e53935;
        }

        .context-menu-item:nth-child(3):hover,
        .context-menu-item:nth-child(4):hover {
            background: rgba(229, 57, 53, 0.1);
        }

        /* æŒ‰é’®æ‹–æ”¾æ ·å¼ */
        .sound-button {
            position: relative;
            overflow: hidden;
        }

        /* æŒ‰é’®æ‹–æ”¾æç¤ºé®ç½©å±‚ */
        .sound-button::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(52, 152, 255, 0);
            border: 2px dashed transparent;
            border-radius: 8px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 1;
        }

        /* æŒ‰é’®æ‹–æ”¾æç¤ºæ–‡å­— */
        .sound-button::before {
            content: 'æ›¿æ¢æ­¤æŒ‰é’®çš„éŸ³æ•ˆ';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #3498ff;
            font-size: 14px;
            font-weight: 500;
            white-space: nowrap;
            z-index: 2;
            pointer-events: none;
            opacity: 0;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 4px;
        }

        /* æŒ‰é’®æ‹–æ”¾æ‚¬åœçŠ¶æ€ */
        .sound-button.dragover::after {
            opacity: 1;
            background: rgba(52, 152, 255, 0.1);
            border-color: #3498ff;
        }

        .sound-button.dragover::before {
            opacity: 1;
        }

        .sound-button.dragover span {
            opacity: 0.3;
        }

        /* ç½‘æ ¼åŒºåŸŸæ‹–æ”¾æ ·å¼ */
        .button-grid {
            position: relative;
        }

        .button-grid::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(76, 175, 80, 0);
            border: 3px dashed transparent;
            border-radius: 8px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            z-index: 1;
        }

        .button-grid::before {
            content: 'æ‹–æ”¾åˆ°æ­¤å¤„åˆ›å»ºæ–°æŒ‰é’®';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #4caf50;
            font-size: 18px;
            font-weight: 500;
            white-space: nowrap;
            z-index: 2;
            pointer-events: none;
            opacity: 0;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.95);
            padding: 8px 16px;
            border-radius: 6px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .button-grid.dragover::after {
            opacity: 1;
            background: rgba(76, 175, 80, 0.1);
            border-color: #4caf50;
        }

        .button-grid.dragover::before {
            opacity: 1;
        }

        /* é€šçŸ¥ç³»ç»Ÿæ ·å¼ */
        .notification-container {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            pointer-events: none;
        }

        .notification {
            min-width: 200px;
            max-width: 240px;
            padding: 10px 16px;
            border-radius: 8px;
            background: rgba(0, 0, 0, 0.65); /* é™ä½èƒŒæ™¯é€æ˜åº¦ */
            backdrop-filter: blur(12px); /* å¢åŠ æ¨¡ç³Šæ•ˆæœ */
            color: rgba(255, 255, 255, 0.95); /* ç¨å¾®æŸ”å’Œçš„æ–‡å­—é¢œè‰² */
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 8px;
            opacity: 0;
            transform: translateY(-20px) scale(0.95);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08); /* æ›´æŸ”å’Œçš„é˜´å½± */
            border: 1px solid rgba(255, 255, 255, 0.1); /* æ·»åŠ å¾®å¦™çš„è¾¹æ¡† */
        }

        .notification::before {
            content: '';
            width: 16px; /* å‡å°å›¾æ ‡å¤§å° */
            height: 16px;
            background-position: center;
            background-repeat: no-repeat;
            background-size: contain;
            flex-shrink: 0; /* é˜²æ­¢å›¾æ ‡è¢«å‹ç¼© */
        }

        .notification.success::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='rgba(76, 175, 80, 0.9)'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z'/%3E%3C/svg%3E");
        }

        .notification.error::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='rgba(244, 67, 54, 0.9)'%3E%3Cpath d='M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z'/%3E%3C/svg%3E");
        }

        .notification.info::before {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='rgba(33, 150, 243, 0.9)'%3E%3Cpath d='M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z'/%3E%3C/svg%3E");
        }

        .notification.show {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        /* æ·»åŠ åŠ¨ç”»æ•ˆæœ */
        @keyframes notification-in {
            from {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        @keyframes notification-out {
            from {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            to {
                opacity: 0;
                transform: translateY(-20px) scale(0.95);
            }
        }

        .notification.show {
            animation: notification-in 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .notification.hide {
            animation: notification-out 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        }

        /* åœ¨å·²æœ‰çš„æ ·å¼ä¸­æ·»åŠ  */
        .audio-output-control {
            display: flex;
            align-items: center;
            margin-left: 15px;
        }

        .audio-output-select {
            padding: 4px 8px;
            border-radius: 4px;
            border: 1px solid #ccc;
            background: #fff;
            font-size: 12px;
            color: #333;
            cursor: pointer;
            outline: none;
            min-width: 150px;
        }

        .audio-output-select:hover {
            border-color: #999;
        }

        .audio-output-select:focus {
            border-color: #3498ff;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="title-bar">
            <span>éŸ³æ•ˆæŒ‰é’®</span>
            <div class="window-controls">
                <button class="min-button">â”€</button>
                <button class="close-button">Ã—</button>
            </div>
        </div>

        <div class="main-content">
            <div class="left-menu">
                <div class="menu-item">å£°éŸ³</div>
                <div class="menu-item">ä¿¡æ¯</div>
                <div class="menu-item">æ‰«æ</div>
                <div class="menu-item">æ³¨é‡Š</div>
                <div class="menu-item">è‡ªåŠ¨</div>
                <div class="menu-item">è®¾ç½®</div>
            </div>

            <div style="flex: 1; display: flex; flex-direction: column;">
                <div class="category-tabs">
                    <button class="tab-item" id="editTab">ç¼–è¾‘</button>
                    <button class="tab-item active">ä¸»æŒ</button>
                    <button class="tab-item">å–Šéº¦</button>
                    <button class="tab-item">æç¬‘</button>
                    <button class="tab-item">æ¸¸æˆ</button>
                    <button class="tab-item">ç”Ÿæ´»</button>
                    <button class="tab-item">DIY</button>
                </div>

                <div class="button-grid" id="buttonGrid"></div>
            </div>
        </div>

        <div class="bottom-bar">
            <div class="playback-controls">
                <!-- å·¦ä¾§æ’­æ”¾ä¿¡æ¯ -->
                <div class="playback-info">
                    <span>å½“å‰æ’­æ”¾: æ— </span>
                </div>
                
                <!-- å³ä¾§æ§åˆ¶å…ƒç´  -->
                <div class="control-elements">
                    <button class="stop-button">åœæ­¢</button>
                    <div class="time-display">00:00 / 00:00</div>
                    <div class="audio-output-control">
                        <select id="audioOutput" class="audio-output-select">
                            <option value="">æ­£åœ¨åŠ è½½éŸ³é¢‘è®¾å¤‡...</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="dialog-overlay" id="dialogOverlay" style="display: none;">
        <div id="createCategoryDialog">
            <h3>åˆ›å»ºæ–°åˆ†ç±»</h3>
            <input type="text" id="newCategoryInput" placeholder="è¯·è¾“å…¥åˆ†ç±»åç§°" maxlength="10">
            <div class="dialog-buttons">
                <button id="cancelCreate">å–æ¶ˆ</button>
                <button id="confirmCreate">åˆ›å»º</button>
            </div>
        </div>
    </div>

    <div class="settings-container" style="display: none;">
        <div class="settings-group">
            <div class="settings-title">æ’­æ”¾è®¾ç½®</div>
            <div class="settings-item">
                <label>å¤–éƒ¨éŸ³ä¹æ§åˆ¶</label>
                <select id="audioControl">
                    <option value="none">ä¸æ§åˆ¶</option>
                    <option value="pause">æš‚åœå¤–éƒ¨éŸ³ä¹</option>
                    <option value="lower">é™ä½å¤–éƒ¨éŸ³ä¹éŸ³é‡</option>
                </select>
            </div>
            <!-- æ·»åŠ æµ‹è¯•æŒ‰é’® -->
            <div class="settings-item" style="margin-top: 10px;">
                <button id="testKugou" style="padding: 8px 16px; cursor: pointer;">
                    æµ‹è¯•é…·ç‹—çŠ¶æ€
                </button>
            </div>
        </div>
    </div>

    <!-- æ·»åŠ é€šçŸ¥å®¹å™¨ -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- æ·»åŠ å¿«æ·é”®è®¾ç½®å¯¹è¯æ¡† -->
    <div id="hotkeyDialog" class="dialog-overlay" style="display: none;">
        <div class="dialog-content">
            <h3>è®¾ç½®å¿«æ·é”®</h3>
            <p>è¯·æŒ‰ä¸‹æƒ³è¦è®¾ç½®çš„æŒ‰é”®ç»„åˆ</p>
            <div id="currentHotkey" class="hotkey-display">æŒ‰ä¸‹æŒ‰é”®...</div>
            <div class="dialog-buttons">
                <button id="cancelHotkey">å–æ¶ˆ</button>
                <button id="confirmHotkey">ç¡®å®š</button>
            </div>
        </div>
    </div>

    <script>
        // åˆ é™¤è¿™è¡Œï¼Œå› ä¸ºå·²ç»åœ¨å…¶ä»–åœ°æ–¹å£°æ˜è¿‡äº†
        // const ipcRenderer = window.electron.ipcRenderer;

        // åˆå§‹åŒ–å…¨å±€å˜é‡
        window.currentAudio = null;
        window.selectedAudioOutput = 'default';

        // éŸ³é¢‘æ§åˆ¶å¯¹è±¡
        window.audioControl = {
            currentAudio: null,
            stopAllAudio() {
                // ... ä¿æŒç°æœ‰ä»£ç 
            }
        };

        // é˜²æŠ–æ§åˆ¶å¯¹è±¡
        window.debounceControl = {
            // ... ä¿æŒç°æœ‰ä»£ç 
        };
    </script>
</body>
</html> 
